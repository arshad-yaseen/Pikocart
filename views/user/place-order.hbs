<style>
    .categories-section{
        display: none !important;
    }
    .header-search{
        display: none !important;
    }
</style>

<section>
    <form class=" height-91 w-full flex" id="checkout-form">

        {{#if orderDetails}}
        <div class="width-65 h-full flex px-8 flex-wrap content-start">
            <div class="width-100 h-12 flex px-2 ">
                 <button type="button" class="rounded-md small-text h-6 text-white px-3 bg-primary font-medium mt-3 flex items-center" ><?xml version="1.0" encoding="UTF-8"?>
<svg class="mr-1" width="18px" height="18px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
    <title>Iconly/Bold/Location</title>
    <g id="Iconly/Bold/Location" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
        <g id="Location" transform="translate(3.500000, 2.000000)" fill="#fff" fill-rule="nonzero">
            <path d="M8.49344564,0 C13.1561184,0 17,3.71789185 17,8.31775805 C17,10.6356906 16.1570081,12.787628 14.7695,14.611575 C13.2388042,16.6235165 11.3521561,18.3764655 9.22854262,19.7524254 C8.74251142,20.0704162 8.3038733,20.0944155 7.77044902,19.7524254 C5.63473516,18.3764655 3.74808708,16.6235165 2.23050003,14.611575 C0.84198351,12.787628 0,10.6356906 0,8.31775805 C0,3.71789185 3.84388161,0 8.49344564,0 Z M8.49344564,5.77683196 C6.95165787,5.77683196 5.6942286,7.04779499 5.6942286,8.57675052 C5.6942286,10.1177057 6.95165787,11.3296704 8.49344564,11.3296704 C10.0362418,11.3296704 11.3057714,10.1177057 11.3057714,8.57675052 C11.3057714,7.04779499 10.0362418,5.77683196 8.49344564,5.77683196 Z"></path>
        </g>
    </g>
                </svg>Use my current location</button>
            </div>
            <div class="width-60 h-12 flex flex-col px-2 ">
                <input required placeholder="Name" type="text" name="name" value="{{orderDetails.deliveryDetails.name}}" class="capitalize focus:outline-none hover:ring-slate-400 focus:ring-slate-500 font-medium mt-2 rounded-md ring-2 ring-slate-300 ring-offset-1 small-text py-1 pl-4 h-6 w-full ">
            </div>
            <div class="width-40 h-12 flex flex-col px-2">
                <input required placeholder="10-Digit mobile number" value="{{orderDetails.deliveryDetails.mobile}}" type="tel" name="mobile" class=" focus:outline-none hover:ring-slate-400 focus:ring-slate-500 font-medium mt-2 rounded-md ring-2 ring-slate-300 ring-offset-1 small-text py-1 pl-4 h-6 w-full ">
            </div>
            <div class="width-40 h-12 flex flex-col px-2">
                <input required placeholder="Pincode" type="number" value="{{orderDetails.deliveryDetails.pincode}}" name="pincode" class=" focus:outline-none hover:ring-slate-400 focus:ring-slate-500 font-medium mt-2 rounded-md ring-2 ring-slate-300 ring-offset-1 small-text py-1 pl-4 h-6 w-full pr-3">
            </div>
            <div class="width-60 h-12 flex flex-col px-2">
                <input required placeholder="Place" type="text" value="{{orderDetails.deliveryDetails.place}}" name="place" class=" focus:outline-none hover:ring-slate-400 focus:ring-slate-500 font-medium mt-2 rounded-md ring-2 ring-slate-300 ring-offset-1 small-text py-1 pl-4 h-6 w-full ">
            </div>
            <div class="width-100 h-24 flex flex-col px-2">
                <input required placeholder="Address (Area and Street)" value="{{orderDetails.deliveryDetails.address}}" type="text" name="address" class=" focus:outline-none hover:ring-slate-400 focus:ring-slate-500 font-medium mt-2 rounded-md ring-2 ring-slate-300 ring-offset-1 small-text pt-2 pl-4 pb-12 w-full ">
            </div>
            <div class="width-50 h-12 flex flex-col px-2">
                <input required placeholder="City/District/Town" value="{{orderDetails.deliveryDetails.city}}" type="text" name="city" class=" focus:outline-none hover:ring-slate-400 focus:ring-slate-500 font-medium mt-2 rounded-md ring-2 ring-slate-300 ring-offset-1 small-text py-1 pl-4 h-6 w-full ">
            </div>
            <div class="width-50 h-12 flex flex-col px-2">
                <select required name="state" class=" focus:outline-none hover:ring-slate-400 focus:ring-slate-500 font-medium mt-2 rounded-md ring-2 ring-slate-300 ring-offset-1 small-text py-1 pl-4 h-6 w-full cursor-pointer">
                        <option value="{{orderDetails.deliveryDetails.state}}">{{orderDetails.deliveryDetails.state}}</option>
                        <option value="Andaman and Nicobar Islands">Andaman and Nicobar Islands</option>
                        <option value="Andhra Pradesh">Andhra Pradesh</option>
                        <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                        <option value="Assam">Assam</option>
                        <option value="Bihar">Bihar</option>
                        <option value="Chandigarh">Chandigarh</option>
                        <option value="Chhattisgarh">Chhattisgarh</option>
                        <option value="Dadra and Nagar Haveli">Dadra and Nagar Haveli</option>
                        <option value="Daman and Diu">Daman and Diu</option>
                        <option value="Delhi">Delhi</option>
                        <option value="Goa">Goa</option>
                        <option value="Gujarat">Gujarat</option>
                        <option value="Haryana">Haryana</option>
                        <option value="Himachal Pradesh">Himachal Pradesh</option>
                        <option value="Jammu and Kashmir">Jammu and Kashmir</option>
                        <option value="Jharkhand">Jharkhand</option>
                        <option value="Karnataka">Karnataka</option>
                        <option value="Kerala">Kerala</option>
                        <option value="Ladakh">Ladakh</option>
                        <option value="Lakshadweep">Lakshadweep</option>
                        <option value="Madhya Pradesh">Madhya Pradesh</option>
                        <option value="Maharashtra">Maharashtra</option>
                        <option value="Manipur">Manipur</option>
                        <option value="Meghalaya">Meghalaya</option>
                        <option value="Mizoram">Mizoram</option>
                        <option value="Nagaland">Nagaland</option>
                        <option value="Odisha">Odisha</option>
                        <option value="Puducherry">Puducherry</option>
                        <option value="Punjab">Punjab</option>
                        <option value="Rajasthan">Rajasthan</option>
                        <option value="Sikkim">Sikkim</option>
                        <option value="Tamil Nadu">Tamil Nadu</option>
                        <option value="Telangana">Telangana</option>
                        <option value="Tripura">Tripura</option>
                        <option value="Uttar Pradesh">Uttar Pradesh</option>
                        <option value="Uttarakhand">Uttarakhand</option>
                        <option value="West Bengal">West Bengal</option>
                </select>
            </div>
            <div class="width-50 h-12 flex flex-col px-2">
                <input placeholder="Landmark (optional)" type="text" value="{{orderDetails.deliveryDetails.landmark}}" name="landmark" class=" focus:outline-none hover:ring-slate-400 focus:ring-slate-500 font-medium mt-2 rounded-md ring-2 ring-slate-300 ring-offset-1 small-text py-1 pl-4 h-6 w-full ">
            </div>
            <div class="width-50 h-12 flex flex-col px-2">
                <input value="{{orderDetails.deliveryDetails.alternatephone}}" placeholder="Alternate phone (optional)" type="tel" name="alternatephone" class=" focus:outline-none hover:ring-slate-400 focus:ring-slate-500 font-medium mt-2 rounded-md ring-2 ring-slate-300 ring-offset-1 small-text py-1 pl-4 h-6 w-full ">
            </div>
            <div class="width-100 h-16 flex items-center px-2 relative">
               <a href="/" class="text-xs font-medium flex cursor-pointer" ><?xml version="1.0" encoding="UTF-8"?>
<svg class="mr-1" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
    <title>Iconly/Bold/Arrow - Left 2</title>
    <g id="Iconly/Bold/Arrow---Left-2" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
        <g id="Arrow---Left-2" transform="translate(7.000000, 6.000000)" fill="#000000" fill-rule="nonzero">
            <path d="M0.369215782,4.869 C0.425718461,4.811 0.639064783,4.563 0.837798344,4.359 C2.00292255,3.076 5.04237701,0.976 6.63321968,0.335 C6.87481734,0.232 7.48563078,0.014 7.81198246,0 C8.12469557,0 8.42279591,0.072 8.70725767,0.218 C9.06186069,0.422 9.34632245,0.743 9.50219191,1.122 C9.60253288,1.385 9.75840234,2.172 9.75840234,2.186 C9.9142718,3.047 10,4.446 10,5.992 C10,7.465 9.9142718,8.807 9.78665368,9.681 C9.77204092,9.695 9.61617146,10.673 9.44568924,11.008 C9.13297613,11.62 8.52216269,12 7.86848514,12 L7.81198246,12 C7.386264,11.985 6.4909888,11.605 6.4909888,11.591 C4.98587433,10.949 2.01656113,8.952 0.823185582,7.625 C0.823185582,7.625 0.48709206,7.284 0.340964442,7.071 C0.113005358,6.765 -8.8817842e-16,6.386 -8.8817842e-16,6.007 C-8.8817842e-16,5.584 0.12761812,5.19 0.369215782,4.869"></path>
        </g>
    </g>
               </svg>Back to Shopping</a>
               <button class="text-xs font-medium flex cursor-pointer absolute right-6 py-1 px-3  rounded-md ring-2 ring-offset-2 ring-green-500 hover:bg-green-500 hover:text-white text-green-500 transition-colors" >Place Order</button>
            </div>
        </div>
        {{else}}

        <div class="width-65 h-full flex px-8 flex-wrap content-start">
            <div class="width-100 h-12 flex px-2 ">
                 <button type="button" class="rounded-md small-text h-6 text-white px-3 bg-primary font-medium mt-3 flex items-center" ><?xml version="1.0" encoding="UTF-8"?>
<svg class="mr-1" width="18px" height="18px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
    <title>Iconly/Bold/Location</title>
    <g id="Iconly/Bold/Location" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
        <g id="Location" transform="translate(3.500000, 2.000000)" fill="#fff" fill-rule="nonzero">
            <path d="M8.49344564,0 C13.1561184,0 17,3.71789185 17,8.31775805 C17,10.6356906 16.1570081,12.787628 14.7695,14.611575 C13.2388042,16.6235165 11.3521561,18.3764655 9.22854262,19.7524254 C8.74251142,20.0704162 8.3038733,20.0944155 7.77044902,19.7524254 C5.63473516,18.3764655 3.74808708,16.6235165 2.23050003,14.611575 C0.84198351,12.787628 0,10.6356906 0,8.31775805 C0,3.71789185 3.84388161,0 8.49344564,0 Z M8.49344564,5.77683196 C6.95165787,5.77683196 5.6942286,7.04779499 5.6942286,8.57675052 C5.6942286,10.1177057 6.95165787,11.3296704 8.49344564,11.3296704 C10.0362418,11.3296704 11.3057714,10.1177057 11.3057714,8.57675052 C11.3057714,7.04779499 10.0362418,5.77683196 8.49344564,5.77683196 Z"></path>
        </g>
    </g>
                </svg>Use my current location</button>
            </div>
            <div class="width-60 h-12 flex flex-col px-2 ">
                <input required placeholder="Name" type="text" name="name" class="capitalize focus:outline-none hover:ring-slate-400 focus:ring-slate-500 font-medium mt-2 rounded-md ring-2 ring-slate-300 ring-offset-1 small-text py-1 pl-4 h-6 w-full ">
            </div>
            <div class="width-40 h-12 flex flex-col px-2">
                <input required placeholder="10-Digit mobile number" type="tel" name="mobile" class=" focus:outline-none hover:ring-slate-400 focus:ring-slate-500 font-medium mt-2 rounded-md ring-2 ring-slate-300 ring-offset-1 small-text py-1 pl-4 h-6 w-full ">
            </div>
            <div class="width-40 h-12 flex flex-col px-2">
                <input required placeholder="Pincode" type="number" name="pincode" class=" focus:outline-none hover:ring-slate-400 focus:ring-slate-500 font-medium mt-2 rounded-md ring-2 ring-slate-300 ring-offset-1 small-text py-1 pl-4 h-6 w-full pr-3">
            </div>
            <div class="width-60 h-12 flex flex-col px-2">
                <input required placeholder="Place" type="text" name="place" class=" focus:outline-none hover:ring-slate-400 focus:ring-slate-500 font-medium mt-2 rounded-md ring-2 ring-slate-300 ring-offset-1 small-text py-1 pl-4 h-6 w-full ">
            </div>
            <div class="width-100 h-24 flex flex-col px-2">
                <input required placeholder="Address (Area and Street)" type="text" name="address" class=" focus:outline-none hover:ring-slate-400 focus:ring-slate-500 font-medium mt-2 rounded-md ring-2 ring-slate-300 ring-offset-1 small-text pt-2 pl-4 pb-12 w-full ">
            </div>
            <div class="width-50 h-12 flex flex-col px-2">
                <input required placeholder="City/District/Town" type="text" name="city" class=" focus:outline-none hover:ring-slate-400 focus:ring-slate-500 font-medium mt-2 rounded-md ring-2 ring-slate-300 ring-offset-1 small-text py-1 pl-4 h-6 w-full ">
            </div>
            <div class="width-50 h-12 flex flex-col px-2">
                <select required name="state" class=" focus:outline-none hover:ring-slate-400 focus:ring-slate-500 font-medium mt-2 rounded-md ring-2 ring-slate-300 ring-offset-1 small-text py-1 pl-4 h-6 w-full cursor-pointer">
                        <option value="select state">Select state</option>
                        <option value="Andaman and Nicobar Islands">Andaman and Nicobar Islands</option>
                        <option value="Andhra Pradesh">Andhra Pradesh</option>
                        <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                        <option value="Assam">Assam</option>
                        <option value="Bihar">Bihar</option>
                        <option value="Chandigarh">Chandigarh</option>
                        <option value="Chhattisgarh">Chhattisgarh</option>
                        <option value="Dadra and Nagar Haveli">Dadra and Nagar Haveli</option>
                        <option value="Daman and Diu">Daman and Diu</option>
                        <option value="Delhi">Delhi</option>
                        <option value="Goa">Goa</option>
                        <option value="Gujarat">Gujarat</option>
                        <option value="Haryana">Haryana</option>
                        <option value="Himachal Pradesh">Himachal Pradesh</option>
                        <option value="Jammu and Kashmir">Jammu and Kashmir</option>
                        <option value="Jharkhand">Jharkhand</option>
                        <option value="Karnataka">Karnataka</option>
                        <option value="Kerala">Kerala</option>
                        <option value="Ladakh">Ladakh</option>
                        <option value="Lakshadweep">Lakshadweep</option>
                        <option value="Madhya Pradesh">Madhya Pradesh</option>
                        <option value="Maharashtra">Maharashtra</option>
                        <option value="Manipur">Manipur</option>
                        <option value="Meghalaya">Meghalaya</option>
                        <option value="Mizoram">Mizoram</option>
                        <option value="Nagaland">Nagaland</option>
                        <option value="Odisha">Odisha</option>
                        <option value="Puducherry">Puducherry</option>
                        <option value="Punjab">Punjab</option>
                        <option value="Rajasthan">Rajasthan</option>
                        <option value="Sikkim">Sikkim</option>
                        <option value="Tamil Nadu">Tamil Nadu</option>
                        <option value="Telangana">Telangana</option>
                        <option value="Tripura">Tripura</option>
                        <option value="Uttar Pradesh">Uttar Pradesh</option>
                        <option value="Uttarakhand">Uttarakhand</option>
                        <option value="West Bengal">West Bengal</option>
                </select>
            </div>
            <div class="width-50 h-12 flex flex-col px-2">
                <input placeholder="Landmark (optional)" type="text" name="landmark" class=" focus:outline-none hover:ring-slate-400 focus:ring-slate-500 font-medium mt-2 rounded-md ring-2 ring-slate-300 ring-offset-1 small-text py-1 pl-4 h-6 w-full ">
            </div>
            <div class="width-50 h-12 flex flex-col px-2">
                <input placeholder="Alternate phone (optional)" type="tel" name="alternatephone" class=" focus:outline-none hover:ring-slate-400 focus:ring-slate-500 font-medium mt-2 rounded-md ring-2 ring-slate-300 ring-offset-1 small-text py-1 pl-4 h-6 w-full ">
            </div>
            <div class="width-100 h-16 flex items-center px-2 relative">
               <a href="/" class="text-xs font-medium flex cursor-pointer" ><?xml version="1.0" encoding="UTF-8"?>
<svg class="mr-1" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
    <title>Iconly/Bold/Arrow - Left 2</title>
    <g id="Iconly/Bold/Arrow---Left-2" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
        <g id="Arrow---Left-2" transform="translate(7.000000, 6.000000)" fill="#000000" fill-rule="nonzero">
            <path d="M0.369215782,4.869 C0.425718461,4.811 0.639064783,4.563 0.837798344,4.359 C2.00292255,3.076 5.04237701,0.976 6.63321968,0.335 C6.87481734,0.232 7.48563078,0.014 7.81198246,0 C8.12469557,0 8.42279591,0.072 8.70725767,0.218 C9.06186069,0.422 9.34632245,0.743 9.50219191,1.122 C9.60253288,1.385 9.75840234,2.172 9.75840234,2.186 C9.9142718,3.047 10,4.446 10,5.992 C10,7.465 9.9142718,8.807 9.78665368,9.681 C9.77204092,9.695 9.61617146,10.673 9.44568924,11.008 C9.13297613,11.62 8.52216269,12 7.86848514,12 L7.81198246,12 C7.386264,11.985 6.4909888,11.605 6.4909888,11.591 C4.98587433,10.949 2.01656113,8.952 0.823185582,7.625 C0.823185582,7.625 0.48709206,7.284 0.340964442,7.071 C0.113005358,6.765 -8.8817842e-16,6.386 -8.8817842e-16,6.007 C-8.8817842e-16,5.584 0.12761812,5.19 0.369215782,4.869"></path>
        </g>
    </g>
               </svg>Back to Shopping</a>
               <button class="text-xs font-medium flex cursor-pointer absolute right-6 py-1 px-3  rounded-md ring-2 ring-offset-2 ring-green-500 hover:bg-green-500 hover:text-white text-green-500 transition-colors" >Place Order</button>
            </div>
        </div>

        {{/if}}
        <div class="width-35 h-full flex flex-col items-center pt-6 px-8 bg-slate-50">
            <div class="w-full h-48 bg-white rounded-sm flex flex-col px-4 py-3">
                <h1 class="text-xs text-slate-400 border-b-2 border-slate-200 pb-2 font-medium" >PRICE DETAILS</h1>
                <p class="text-xs mt-3 font-medium relative flex items-center" >Price (2 items) <span class="text-xs font-medium font-sans absolute right-2" >₹{{totalPrice}}</span></p>
                <p class="text-xs mt-3 font-medium pb-3 border-b-2 border-slate-100 relative flex items-center" >Delivery Charges <span class="text-xs absolute right-2 font-medium font-sans text-fourth" >FREE</span></p>
                <p class="text-xs mt-3 font-medium pb-3 border-b-2 border-slate-100 relative flex items-center" >Total Payable <span class="text-xs font-medium font-sans absolute right-2" >₹{{totalPrice}}</span></p>
            </div>
           
            <div class="w-full h-36 bg-white rounded-sm flex flex-col px-4 py-3">
                <h1 class="text-xs text-slate-400 border-b-2 border-slate-200 pb-2 font-medium mb-2" >PAYMENT OPTIONS</h1>
                <label class=" w-full h-6 flex items-center" >
                <input checked type="radio" name="paymentmethod" value="COD" class="mr-2 cursor-pointer">
                <p class="text-xs font-medium inline-block" for="text">Cash on delivery</p>
                </label>
                <label class=" w-full h-6 flex items-center mt-1" >
                <input type="radio" name="paymentmethod" value="ONLINE" class="mr-2 cursor-pointer">
                <p class="text-xs font-medium inline-block" for="text">Online Payment</p>
                </label>
                <input type="text" class="hidden" name="userID" value="{{user._id}}">
            </div>
       
        </div>
    </form>
</section>
<script>
    $("#checkout-form").submit((e)=> {
        e.preventDefault()
        $.ajax({
            url: '/place-order',
            method: 'post',
            data:$("#checkout-form").serialize(),
            success:(response)=> {
                if(response.codStatus){
                    location.href='/order-placed'
                }else{
                    razorpayPayment(response)
                }
            }
        })
    })

    function razorpayPayment(order){
        var options = {
    "key": "rzp_test_y3s5vVhYBefajW", // Enter the Key ID generated from the Dashboard
    "amount": order.amount, // Amount is in currency subunits. Default currency is INR. Hence, 50000 refers to 50000 paise
    "currency": "INR",
    "name": "Pikocart",
    "description": "Pay for Pikocart",
    "image": "",
    "order_id": order.id, //This is a sample Order ID. Pass the `id` obtained in the response of Step 1
    "handler": function (response){
        verifyPayment(response,order)
    },
    "prefill": {
        "name": "Arshad Yaseen",
        "email": "arshadpyaseen@gmail.com",
        "contact": "9946365417"
    },
    "notes": {
        "address": "Razorpay Corporate Office"
    },
    "theme": {
        "color": "#3399cc"
    }
};
var rzp1 = new Razorpay(options);
rzp1.open();
    }

    function verifyPayment(payment, order){
        $.ajax({
            url:'/verify-payment',
            data:{
                payment,
                order
            },
            method: 'post',
            success:(response)=> {
                if(response.status){
                    location.href='/order-placed'
                }else{
                    alert('Payment Failed')
                }
            }
        })
    }


</script>



